[{"name":"app.R","content":"library(shiny)\r\nlibrary(shinythemes)\r\nlibrary(lubridate)\r\n\r\n# --- Load Data ---\r\nBatData <- read.csv(\"BattingData2025.csv\", stringsAsFactors = FALSE)\r\nBatData$Date <- as.Date(BatData$Date, format = \"%m/%d/%y\")\r\n\r\n# --- Functions ---\r\nPlateAppearance <- function(data, player) {\r\n  nrow(subset(data, Name == player))\r\n}\r\n\r\nBatAvg <- function(data, player) {\r\n  player_data <- subset(data, Name == player)\r\n  if (nrow(player_data) == 0) return(NA)\r\n  \r\n  AtBats <- subset(player_data,\r\n                   Result %in% c(\"Single\",\"Double\",\"Triple\",\"HR\",\"SO\",\"FO\",\"GO\"))\r\n  Hits <- subset(player_data, Result %in% c(\"Single\",\"Double\",\"Triple\",\"HR\"))\r\n  \r\n  if (nrow(AtBats) == 0) return(NA)\r\n  round(nrow(Hits) / nrow(AtBats), 3)\r\n}\r\n\r\nCalculate_OPS <- function(data, player) {\r\n  player_data <- subset(data, Name == player)\r\n  if (nrow(player_data) == 0) return(list(OBP=NA, SLG=NA, OPS=NA))\r\n  \r\n  TotalPA <- nrow(player_data)\r\n  AtBats <- subset(player_data,\r\n                   Result %in% c(\"Single\",\"Double\",\"Triple\",\"HR\",\"SO\",\"FO\",\"GO\"))\r\n  TotalAtBats <- nrow(AtBats)\r\n  \r\n  OnBase <- subset(player_data, Result %in% c(\"Single\",\"Double\",\"Triple\",\"HR\",\"BB\",\"HBP\"))\r\n  OBP <- nrow(OnBase) / TotalPA\r\n  \r\n  Singles <- nrow(subset(player_data, Result == \"Single\"))\r\n  Doubles <- nrow(subset(player_data, Result == \"Double\"))\r\n  Triples <- nrow(subset(player_data, Result == \"Triple\"))\r\n  HR <- nrow(subset(player_data, Result == \"HR\"))\r\n  \r\n  SLG <- ifelse(TotalAtBats==0, NA, (Singles + 2*Doubles + 3*Triples + 4*HR)/TotalAtBats)\r\n  OPS <- OBP + SLG\r\n  \r\n  list(OBP=round(OBP,3), SLG=round(SLG,3), OPS=round(OPS,3))\r\n}\r\n\r\n# Pie Chart: Balls vs Strikes\r\nPieChart <- function(player_data) {\r\n  Balls <- sum(player_data$Ball, na.rm=TRUE)\r\n  Strikes <- sum(player_data$Strike, na.rm=TRUE)\r\n  Total <- Balls + Strikes\r\n  if (Total == 0) return(NULL)\r\n  \r\n  counts <- c(Balls, Strikes)\r\n  names(counts) <- c(\"Ball\", \"Strike\")\r\n  pie(counts, col=c(\"skyblue\",\"tomato\"), main=\"Pitches Seen\")\r\n}\r\n\r\n# --- Precompute stats for all players ---\r\nPlayerNames <- unique(BatData$Name)\r\nresults_df <- do.call(rbind, lapply(PlayerNames, function(player) {\r\n  stats <- Calculate_OPS(BatData, player)\r\n  ba <- BatAvg(BatData, player)\r\n  player_data <- subset(BatData, Name==player)\r\n  \r\n  data.frame(\r\n    Name = player,\r\n    PA = nrow(player_data),\r\n    BA = ba,\r\n    OBP = stats$OBP,\r\n    SLG = stats$SLG,\r\n    OPS = stats$OPS,\r\n    RBI = sum(player_data$RBI, na.rm=TRUE),\r\n    SB = sum(player_data$StolenBase, na.rm=TRUE),\r\n    SO = sum(player_data$Result==\"SO\", na.rm=TRUE),\r\n    BB = sum(player_data$Result==\"BB\", na.rm=TRUE),\r\n    stringsAsFactors = FALSE\r\n  )\r\n}))\r\nresults_df <- results_df[order(-results_df$OPS), ]\r\n\r\n# --- UI ---\r\nui <- fluidPage(\r\n  theme = shinytheme(\"spacelab\"),\r\n  titlePanel(\"Batting Stats Dashboard\"),\r\n  \r\n  tabsetPanel(\r\n    \r\n    tabPanel(\"Player Stats\",\r\n             wellPanel(\r\n               tableOutput(\"stats_table\")\r\n             )\r\n    ),\r\n    \r\n    tabPanel(\"Player Analysis\",\r\n             sidebarLayout(\r\n               sidebarPanel(\r\n                 selectInput(\"selected_player\", \"Select Player:\", \r\n                             choices = PlayerNames, \r\n                             selected = PlayerNames[1]),\r\n                 width = 2  # Narrow sidebar\r\n               ),\r\n               mainPanel(\r\n                 h3(textOutput(\"selected_player_title\")),\r\n                 \r\n                 wellPanel(\r\n                   tableOutput(\"player_stats_table\")\r\n                 ),\r\n                 wellPanel(\r\n                   tableOutput(\"team_avg_table\")\r\n                 ),\r\n                 \r\n                 fluidRow(\r\n                   column(6, plotOutput(\"pitch_pie_chart\", height=\"300px\")),\r\n                   column(6, plotOutput(\"hits_bar_chart\", height=\"300px\"))\r\n                 ),\r\n                 fluidRow(\r\n                   column(6, plotOutput(\"pa_outcomes_chart\", height=\"300px\")),\r\n                   column(6, plotOutput(\"ba_over_time_chart\", height=\"300px\"))\r\n                 )\r\n               )\r\n             )\r\n    ),\r\n    \r\n    tabPanel(\"Glossary\",\r\n             h3(\"Baseball Statistic Definitions\"),\r\n             tags$ul(\r\n               tags$li(tags$strong(\"PA:\"), \" Plate Appearances\"),\r\n               tags$li(tags$strong(\"BA:\"), \" Batting Average\"),\r\n               tags$li(tags$strong(\"OBP:\"), \" On-base Percentage\"),\r\n               tags$li(tags$strong(\"SLG:\"), \" Slugging Percentage\"),\r\n               tags$li(tags$strong(\"OPS:\"), \" On-base Plus Slugging\"),\r\n               tags$li(tags$strong(\"RBI:\"), \" Runs Batted In\"),\r\n               tags$li(tags$strong(\"SB:\"), \" Stolen Bases\"),\r\n               tags$li(tags$strong(\"SO:\"), \" Strikeouts\"),\r\n               tags$li(tags$strong(\"BB:\"), \" Walks\")\r\n             )\r\n    )\r\n  )\r\n)\r\n\r\n# --- Server ---\r\nserver <- function(input, output, session) {\r\n  \r\n  # Main stats table\r\n  output$stats_table <- renderTable({\r\n    results_df\r\n  }, rownames=FALSE)\r\n  \r\n  # Selected player title\r\n  output$selected_player_title <- renderText({\r\n    req(input$selected_player)\r\n    paste(\"Stats & Pitch Distribution for\", input$selected_player)\r\n  })\r\n  \r\n  # Player stats table\r\n  output$player_stats_table <- renderTable({\r\n    req(input$selected_player)\r\n    subset(results_df, Name == input$selected_player)\r\n  }, rownames=FALSE)\r\n  \r\n  # Team averages table\r\n  output$team_avg_table <- renderTable({\r\n    numeric_cols <- sapply(results_df, is.numeric)\r\n    team_means <- round(colMeans(results_df[, numeric_cols]), 3)\r\n    data.frame(Name=\"Team Average\", t(team_means), stringsAsFactors = FALSE)\r\n  }, rownames=FALSE)\r\n  \r\n  # Pie chart: Balls vs Strikes\r\n  output$pitch_pie_chart <- renderPlot({\r\n    req(input$selected_player)\r\n    player_data <- subset(BatData, Name == input$selected_player)\r\n    PieChart(player_data)\r\n  })\r\n  \r\n  # Bar chart: Hits by type\r\n  output$hits_bar_chart <- renderPlot({\r\n    req(input$selected_player)\r\n    player_data <- subset(BatData, Name == input$selected_player)\r\n    \r\n    hits <- c(\r\n      Single = sum(player_data$Result == \"Single\", na.rm=TRUE),\r\n      Double = sum(player_data$Result == \"Double\", na.rm=TRUE),\r\n      Triple = sum(player_data$Result == \"Triple\", na.rm=TRUE),\r\n      HR = sum(player_data$Result == \"HR\", na.rm=TRUE)\r\n    )\r\n    \r\n    barplot(hits, col=c(\"lightblue\",\"lightgreen\",\"orange\",\"red\"),\r\n            main=\"Hit Type Distribution\",\r\n            ylab=\"Count\", xlab=\"Hit Type\", ylim=c(0, max(hits)+1))\r\n  })\r\n  \r\n  # Bar chart: Plate Appearance outcomes (Hits, SO, BB)\r\n  output$pa_outcomes_chart <- renderPlot({\r\n    req(input$selected_player)\r\n    player_data <- subset(BatData, Name == input$selected_player)\r\n    \r\n    outcomes <- c(\r\n      Hits = sum(player_data$Result %in% c(\"Single\",\"Double\",\"Triple\",\"HR\"), na.rm=TRUE),\r\n      SO = sum(player_data$Result==\"SO\", na.rm=TRUE),\r\n      BB = sum(player_data$Result==\"BB\", na.rm=TRUE)\r\n    )\r\n    \r\n    barplot(outcomes, col=c(\"lightblue\",\"pink\",\"yellow\"),\r\n            main=\"Plate Appearance Outcomes\",\r\n            ylab=\"Count\", xlab=\"Outcome\", ylim=c(0, max(outcomes)+1))\r\n  })\r\n  \r\n  # Line chart: Batting Average over time\r\n  output$ba_over_time_chart <- renderPlot({\r\n    req(input$selected_player)\r\n    player_data <- subset(BatData, Name == input$selected_player)\r\n    player_data <- player_data[order(player_data$Date), ]\r\n    \r\n    AtBats <- player_data$Result %in% c(\"Single\",\"Double\",\"Triple\",\"HR\",\"SO\",\"FO\",\"GO\")\r\n    Hits <- player_data$Result %in% c(\"Single\",\"Double\",\"Triple\",\"HR\")\r\n    \r\n    cum_atbats <- cumsum(AtBats)\r\n    cum_hits <- cumsum(Hits)\r\n    \r\n    cum_ba <- ifelse(cum_atbats == 0, NA, cum_hits / cum_atbats)\r\n    \r\n    plot(player_data$Date, cum_ba, type=\"o\", col=\"blue\", pch=16,\r\n         ylim=c(0,1), ylab=\"Batting Average\", xlab=\"Date\",\r\n         main=\"Batting Average Over Time\")\r\n    grid()\r\n  })\r\n}\r\n\r\n# --- Run App ---\r\nshinyApp(ui, server)\r\n","type":"text"},{"name":"BattingDashboard.Rproj","content":"Version: 1.0\r\n\r\nRestoreWorkspace: Default\r\nSaveWorkspace: Default\r\nAlwaysSaveHistory: Default\r\n\r\nEnableCodeIndexing: Yes\r\nUseSpacesForTab: Yes\r\nNumSpacesForTab: 2\r\nEncoding: UTF-8\r\n\r\nRnwWeave: Sweave\r\nLaTeX: pdfLaTeX\r\n","type":"text"},{"name":"BattingData2025.csv","content":"ï»¿Name,Date,Location,Inning,Ball,Strike,Result,StolenBase,RBI\r\nBarton Z.,5/29/2025,Home,1,1,3,SO,0,0\r\nJustin T.,5/29/2025,Home,1,2,3,SO,0,0\r\nEdgar C.,5/29/2025,Home,1,4,2,BB,0,0\r\nCarter H.,5/29/2025,Home,1,1,3,SO,0,0\r\nBrayan P.,5/29/2025,Home,2,4,1,BB,0,0\r\nHuanchao Y.,5/29/2025,Home,2,0,3,SO,0,0\r\nJavier E.,5/29/2025,Home,2,4,0,BB,0,0\r\nMiguel R.,5/29/2025,Home,2,2,3,SO,0,0\r\nBarton Z.,5/29/2025,Home,3,0,0,Single,0,0\r\nJustin T.,5/29/2025,Home,3,4,0,BB,0,0\r\nEdgar C.,5/29/2025,Home,3,2,3,SO,0,0\r\nCarter H.,5/29/2025,Home,3,0,0,Double,0,2\r\nBrayan P.,5/29/2025,Home,3,4,0,BB,0,0\r\nHuanchao Y.,5/29/2025,Home,3,3,3,SO,0,0\r\nBarton Z.,5/22/2025,Home,1,0,3,SO,0,0\r\nNoah H.,5/22/2025,Home,1,4,0,BB,1,0\r\nEdgar C.,5/22/2025,Home,1,4,0,BB,0,0\r\nJustin T.,5/22/2025,Home,1,4,1,BB,0,0\r\nCarter H.,5/22/2025,Home,1,2,3,SO,0,0\r\nBrayan P.,5/22/2025,Home,1,1,0,Single,0,1\r\nHuanchao Y.,5/22/2025,Home,1,4,0,BB,0,0\r\nMiguel R.,5/22/2025,Home,1,0,3,SO,0,0\r\nShilin H.,5/22/2025,Home,2,4,2,BB,0,0\r\nBarton Z.,5/22/2025,Home,2,1,0,HBP,0,0\r\nNoah H.,5/22/2025,Home,2,1,2,HBP,0,0\r\nEdgar C.,5/22/2025,Home,2,4,2,BB,0,1\r\nJustin T.,5/22/2025,Home,2,1,1,HBP,0,1\r\nBarton Z.,5/16/2025,Home,1,4,1,BB,0,1\r\nNoah H.,5/16/2025,Home,1,2,3,SO,0,0\r\nEdgar C.,5/16/2025,Home,1,4,1,BB,0,0\r\nJustin T.,5/16/2025,Home,1,1,1,Single,0,0\r\nCarter H.,5/16/2025,Home,1,4,1,BB,0,0\r\nJavier E.,5/16/2025,Home,1,0,3,SO,0,0\r\nBrayan P.,5/16/2025,Home,2,4,2,BB,0,0\r\nShilin H.,5/16/2025,Home,2,4,2,BB,0,0\r\nMiguel R.,5/16/2025,Home,2,2,2,GO,0,0\r\nBarton Z.,5/16/2025,Home,2,2,3,SO,0,0\r\nNoah H.,5/16/2025,Home,2,1,3,SO,0,0\r\nEdgar C.,5/16/2025,Home,3,3,2,FO,0,0\r\nJustin T.,5/16/2025,Home,3,3,3,SO,0,0\r\nCarter H.,5/16/2025,Home,3,1,3,SO,0,0\r\nNoah H.,5/15/2025,Home,1,4,1,BB,0,0\r\nBarton Z.,5/15/2025,Home,1,4,1,BB,0,0\r\nJustin T.,5/15/2025,Home,1,4,2,BB,0,0\r\nCarter H.,5/15/2025,Home,1,2,1,Single,0,2\r\nJavier E.,5/15/2025,Home,1,4,0,BB,0,0\r\nShilin H.,5/15/2025,Home,1,1,3,SO,0,0\r\nMiguel R.,5/15/2025,Home,1,2,3,SO,0,0\r\nHuanchao Y.,5/15/2025,Home,1,4,2,BB,0,1\r\nAiden L.,5/15/2025,Home,1,2,3,SO,0,0\r\nNoah H.,5/15/2025,Home,2,4,1,BB,3,0\r\nBarton Z.,5/15/2025,Home,2,3,3,SO,0,0\r\nJustin T.,5/15/2025,Home,2,1,1,HBP,0,0\r\nCarter H.,5/15/2025,Home,2,1,0,HBP,0,0\r\nJavier E.,5/15/2025,Home,2,0,3,SO,0,0\r\nShilin H.,5/15/2025,Home,2,4,2,BB,0,0\r\nMiguel R.,5/15/2025,Home,2,0,3,SO,0,0\r\nHuanchao Y.,5/15/2025,Home,3,4,2,BB,0,0\r\nAiden L.,5/15/2025,Home,3,0,1,HBP,0,0\r\nNoah H.,5/15/2025,Home,3,0,1,FO,0,0\r\nBarton Z.,5/8/2025,Home,1,1,0,HR,0,1\r\nNoah H.,5/8/2025,Home,1,2,3,SO,0,0\r\nBrayan P.,5/8/2025,Home,1,1,3,SO,0,0\r\nEdgar C.,5/8/2025,Home,1,1,0,Single,0,0\r\nJustin T.,5/8/2025,Home,1,2,0,GO,0,0\r\nJavier E.,5/8/2025,Home,2,4,2,BB,0,0\r\nHuanchao Y.,5/8/2025,Home,2,4,1,BB,0,0\r\nCarter H.,5/8/2025,Home,2,0,3,SO,0,0\r\nBarton Z.,5/8/2025,Home,2,0,0,Single,0,2\r\nNoah H.,5/8/2025,Home,2,0,0,Double,0,0\r\nBrayan P.,5/8/2025,Home,2,1,3,SO,0,0\r\nBarton Z.,5/2/2025,Home,1,2,3,SO,0,0\r\nNoah H.,5/2/2025,Home,1,1,0,GO,0,0\r\nJustin T.,5/2/2025,Home,1,4,1,BB,0,0\r\nJavier E.,5/2/2025,Home,1,3,3,SO,0,0\r\nBrayan P.,5/2/2025,Home,2,0,1,FO,0,0\r\nAiden L.,5/2/2025,Home,2,4,2,BB,0,0\r\nHuanchao Y.,5/2/2025,Home,2,3,3,SO,0,0\r\nShilin H.,5/2/2025,Home,2,2,3,SO,0,0\r\n","type":"text"}]

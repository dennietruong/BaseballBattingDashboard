[{"name":"app.R","content":"library(shiny)\r\nlibrary(shinythemes)\r\nlibrary(lubridate)\r\nlibrary(DT)\r\n\r\n# ======================\r\n# Load Data\r\n# ======================\r\nBatData <- read.csv(\"BattingData2025.csv\", stringsAsFactors = FALSE)\r\nBatData$Date <- as.Date(BatData$Date, format = \"%m/%d/%y\")\r\n\r\n# ======================\r\n# Functions\r\n# ======================\r\nBatAvg <- function(data, player) {\r\n  p <- subset(data, Name == player)\r\n  ab <- p$Result %in% c(\"Single\",\"Double\",\"Triple\",\"HR\",\"SO\",\"FO\",\"GO\")\r\n  h  <- p$Result %in% c(\"Single\",\"Double\",\"Triple\",\"HR\")\r\n  if (sum(ab) == 0) return(NA)\r\n  round(sum(h) / sum(ab), 3)\r\n}\r\n\r\nCalculate_OPS <- function(data, player) {\r\n  p <- subset(data, Name == player)\r\n  if (nrow(p) == 0) return(list(OBP=NA, SLG=NA, OPS=NA))\r\n  \r\n  ab <- p$Result %in% c(\"Single\",\"Double\",\"Triple\",\"HR\",\"SO\",\"FO\",\"GO\")\r\n  onbase <- p$Result %in% c(\"Single\",\"Double\",\"Triple\",\"HR\",\"BB\",\"HBP\")\r\n  \r\n  singles <- sum(p$Result==\"Single\")\r\n  doubles <- sum(p$Result==\"Double\")\r\n  triples <- sum(p$Result==\"Triple\")\r\n  hr <- sum(p$Result==\"HR\")\r\n  \r\n  OBP <- sum(onbase) / nrow(p)\r\n  SLG <- ifelse(sum(ab)==0, NA,\r\n                (singles + 2*doubles + 3*triples + 4*hr)/sum(ab))\r\n  \r\n  list(\r\n    OBP = round(OBP,3),\r\n    SLG = round(SLG,3),\r\n    OPS = round(OBP + SLG,3)\r\n  )\r\n}\r\n\r\nPieChart <- function(player_data) {\r\n  balls <- sum(player_data$Ball, na.rm=TRUE)\r\n  strikes <- sum(player_data$Strike, na.rm=TRUE)\r\n  total <- balls + strikes\r\n  if (total == 0) return(NULL)\r\n  \r\n  counts <- c(balls, strikes)\r\n  pct <- round(100 * counts / total, 1)\r\n  \r\n  pie(\r\n    counts,\r\n    labels = paste0(pct, \"%\"),\r\n    col = c(\"#6BAED6\", \"#FB6A4A\"),\r\n    border = \"white\",\r\n    main = \"Pitches Seen\",\r\n    cex = 1.3\r\n  )\r\n  \r\n  legend(\r\n    \"topright\",\r\n    legend = c(\r\n      paste(\"Ball:\", balls),\r\n      paste(\"Strike:\", strikes)\r\n    ),\r\n    fill = c(\"#6BAED6\", \"#FB6A4A\"),\r\n    bty = \"n\"\r\n  )\r\n}\r\n\r\n# ======================\r\n# Precompute Player Stats\r\n# ======================\r\nPlayerNames <- unique(BatData$Name)\r\n\r\nresults_df <- do.call(rbind, lapply(PlayerNames, function(player) {\r\n  stats <- Calculate_OPS(BatData, player)\r\n  p <- subset(BatData, Name == player)\r\n  \r\n  data.frame(\r\n    Name = player,\r\n    PA = nrow(p),\r\n    BA = BatAvg(BatData, player),\r\n    OBP = stats$OBP,\r\n    SLG = stats$SLG,\r\n    OPS = stats$OPS,\r\n    RBI = sum(p$RBI, na.rm=TRUE),\r\n    SB  = sum(p$StolenBase, na.rm=TRUE),\r\n    SO  = sum(p$Result==\"SO\"),\r\n    BB  = sum(p$Result==\"BB\"),\r\n    stringsAsFactors = FALSE\r\n  )\r\n}))\r\n\r\nresults_df <- results_df[order(-results_df$OPS), ]\r\n\r\n# ======================\r\n# UI\r\n# ======================\r\nui <- fluidPage(\r\n  theme = shinytheme(\"spacelab\"),\r\n  titlePanel(\"Batting Stats Dashboard\"),\r\n  \r\n  tabsetPanel(\r\n    \r\n    tabPanel(\"Player Stats\",\r\n             DTOutput(\"stats_table\")\r\n    ),\r\n    \r\n    tabPanel(\"Player Analysis\",\r\n             sidebarLayout(\r\n               sidebarPanel(\r\n                 selectInput(\"selected_player\", \"Select Player:\",\r\n                             choices = PlayerNames),\r\n                 width = 2\r\n               ),\r\n               \r\n               mainPanel(\r\n                 h3(textOutput(\"selected_player_title\")),\r\n                 \r\n                 DTOutput(\"player_stats_table\"),\r\n                 DTOutput(\"team_avg_table\"),\r\n                 \r\n                 fluidRow(\r\n                   column(6, plotOutput(\"pitch_pie_chart\", height=\"300px\")),\r\n                   column(6, plotOutput(\"hits_bar_chart\", height=\"300px\"))\r\n                 ),\r\n                 \r\n                 fluidRow(\r\n                   column(6, plotOutput(\"pa_outcomes_chart\", height=\"300px\")),\r\n                   column(6, plotOutput(\"ba_over_time_chart\", height=\"300px\"))\r\n                 )\r\n               )\r\n             )\r\n    ),\r\n    \r\n    tabPanel(\"Glossary\",\r\n             h3(\"Baseball Statistic Definitions\"),\r\n             tags$ul(\r\n               tags$li(tags$strong(\"PA:\"), \" Plate Appearances\"),\r\n               tags$li(tags$strong(\"BA:\"), \" Batting Average\"),\r\n               tags$li(tags$strong(\"OBP:\"), \" On-base Percentage\"),\r\n               tags$li(tags$strong(\"SLG:\"), \" Slugging Percentage\"),\r\n               tags$li(tags$strong(\"OPS:\"), \" On-base Plus Slugging\"),\r\n               tags$li(tags$strong(\"RBI:\"), \" Runs Batted In\"),\r\n               tags$li(tags$strong(\"SB:\"), \" Stolen Bases\"),\r\n               tags$li(tags$strong(\"SO:\"), \" Strikeouts\"),\r\n               tags$li(tags$strong(\"BB:\"), \" Walks\")\r\n             )\r\n    )\r\n  )\r\n)\r\n\r\n# ======================\r\n# Server\r\n# ======================\r\nserver <- function(input, output, session) {\r\n  \r\n  par(\r\n    mar = c(4,4,3,1),\r\n    cex.axis = 1.1,\r\n    cex.lab = 1.2,\r\n    cex.main = 1.4,\r\n    font.main = 2\r\n  )\r\n  \r\n  output$stats_table <- renderDT({\r\n    datatable(\r\n      results_df,\r\n      rownames = FALSE,\r\n      options = list(pageLength = 10, scrollX = TRUE)\r\n    ) %>% formatRound(c(\"BA\",\"OBP\",\"SLG\",\"OPS\"), 3)\r\n  })\r\n  \r\n  output$selected_player_title <- renderText({\r\n    paste(\"Stats & Visuals for\", input$selected_player)\r\n  })\r\n  \r\n  output$player_stats_table <- renderDT({\r\n    datatable(\r\n      subset(results_df, Name == input$selected_player),\r\n      rownames = FALSE,\r\n      options = list(dom = \"t\")\r\n    )\r\n  })\r\n  \r\n  output$team_avg_table <- renderDT({\r\n    nums <- sapply(results_df, is.numeric)\r\n    avg <- round(colMeans(results_df[, nums]), 3)\r\n    datatable(\r\n      data.frame(Name=\"Team Average\", t(avg)),\r\n      rownames = FALSE,\r\n      options = list(dom = \"t\")\r\n    )\r\n  })\r\n  \r\n  output$pitch_pie_chart <- renderPlot({\r\n    PieChart(subset(BatData, Name == input$selected_player))\r\n  })\r\n  \r\n  output$hits_bar_chart <- renderPlot({\r\n    p <- subset(BatData, Name == input$selected_player)\r\n    hits <- c(\r\n      Single = sum(p$Result==\"Single\"),\r\n      Double = sum(p$Result==\"Double\"),\r\n      Triple = sum(p$Result==\"Triple\"),\r\n      HR = sum(p$Result==\"HR\")\r\n    )\r\n    \r\n    barplot(\r\n      hits,\r\n      col = c(\"#9ECAE1\",\"#6BAED6\",\"#4292C6\",\"#2171B5\"),\r\n      border = NA,\r\n      main = \"Hit Type Distribution\",\r\n      ylab = \"Count\",\r\n      ylim = c(0, max(hits)+1)\r\n    )\r\n    \r\n    text(seq_along(hits), hits, labels=hits, pos=3)\r\n  })\r\n  \r\n  output$pa_outcomes_chart <- renderPlot({\r\n    p <- subset(BatData, Name == input$selected_player)\r\n    outcomes <- c(\r\n      Hits = sum(p$Result %in% c(\"Single\",\"Double\",\"Triple\",\"HR\")),\r\n      SO = sum(p$Result==\"SO\"),\r\n      BB = sum(p$Result==\"BB\")\r\n    )\r\n    \r\n    barplot(\r\n      outcomes,\r\n      col = c(\"#74C476\",\"#FB6A4A\",\"#FDD0A2\"),\r\n      border = NA,\r\n      main = \"Plate Appearance Outcomes\",\r\n      ylab = \"Count\",\r\n      ylim = c(0, max(outcomes)+1)\r\n    )\r\n    \r\n    text(seq_along(outcomes), outcomes, labels=outcomes, pos=3)\r\n  })\r\n  \r\n  output$ba_over_time_chart <- renderPlot({\r\n    p <- subset(BatData, Name == input$selected_player)\r\n    p <- p[order(p$Date), ]\r\n    \r\n    ab <- p$Result %in% c(\"Single\",\"Double\",\"Triple\",\"HR\",\"SO\",\"FO\",\"GO\")\r\n    h  <- p$Result %in% c(\"Single\",\"Double\",\"Triple\",\"HR\")\r\n    \r\n    ba <- ifelse(cumsum(ab)==0, NA, cumsum(h)/cumsum(ab))\r\n    \r\n    plot(\r\n      p$Date, ba,\r\n      type=\"o\",\r\n      pch=16,\r\n      lwd=2,\r\n      col=\"#3182BD\",\r\n      ylim=c(0,1),\r\n      main=\"Batting Average Over Time\",\r\n      ylab=\"Batting Average\",\r\n      xlab=\"Date\"\r\n    )\r\n    \r\n    grid(col=\"gray90\", lty=\"dotted\")\r\n  })\r\n}\r\n\r\nshinyApp(ui, server)\r\n\r\n\r\n\r\n\r\n#Type this to console to download info to docs folder: shinylive::export(appdir = \"../BattingDashboard/\", destdir = \"docs\")","type":"text"},{"name":"BattingDashboard.Rproj","content":"Version: 1.0\r\n\r\nRestoreWorkspace: Default\r\nSaveWorkspace: Default\r\nAlwaysSaveHistory: Default\r\n\r\nEnableCodeIndexing: Yes\r\nUseSpacesForTab: Yes\r\nNumSpacesForTab: 2\r\nEncoding: UTF-8\r\n\r\nRnwWeave: Sweave\r\nLaTeX: pdfLaTeX\r\n","type":"text"},{"name":"BattingData2025.csv","content":"ï»¿Name,Date,Location,Inning,Ball,Strike,Result,StolenBase,RBI\r\nBarton Z.,5/29/2025,Home,1,1,3,SO,0,0\r\nJustin T.,5/29/2025,Home,1,2,3,SO,0,0\r\nEdgar C.,5/29/2025,Home,1,4,2,BB,0,0\r\nCarter H.,5/29/2025,Home,1,1,3,SO,0,0\r\nBrayan P.,5/29/2025,Home,2,4,1,BB,0,0\r\nHuanchao Y.,5/29/2025,Home,2,0,3,SO,0,0\r\nJavier E.,5/29/2025,Home,2,4,0,BB,0,0\r\nMiguel R.,5/29/2025,Home,2,2,3,SO,0,0\r\nBarton Z.,5/29/2025,Home,3,0,0,Single,0,0\r\nJustin T.,5/29/2025,Home,3,4,0,BB,0,0\r\nEdgar C.,5/29/2025,Home,3,2,3,SO,0,0\r\nCarter H.,5/29/2025,Home,3,0,0,Double,0,2\r\nBrayan P.,5/29/2025,Home,3,4,0,BB,0,0\r\nHuanchao Y.,5/29/2025,Home,3,3,3,SO,0,0\r\nBarton Z.,5/22/2025,Home,1,0,3,SO,0,0\r\nNoah H.,5/22/2025,Home,1,4,0,BB,1,0\r\nEdgar C.,5/22/2025,Home,1,4,0,BB,0,0\r\nJustin T.,5/22/2025,Home,1,4,1,BB,0,0\r\nCarter H.,5/22/2025,Home,1,2,3,SO,0,0\r\nBrayan P.,5/22/2025,Home,1,1,0,Single,0,1\r\nHuanchao Y.,5/22/2025,Home,1,4,0,BB,0,0\r\nMiguel R.,5/22/2025,Home,1,0,3,SO,0,0\r\nShilin H.,5/22/2025,Home,2,4,2,BB,0,0\r\nBarton Z.,5/22/2025,Home,2,1,0,HBP,0,0\r\nNoah H.,5/22/2025,Home,2,1,2,HBP,0,0\r\nEdgar C.,5/22/2025,Home,2,4,2,BB,0,1\r\nJustin T.,5/22/2025,Home,2,1,1,HBP,0,1\r\nBarton Z.,5/16/2025,Home,1,4,1,BB,0,1\r\nNoah H.,5/16/2025,Home,1,2,3,SO,0,0\r\nEdgar C.,5/16/2025,Home,1,4,1,BB,0,0\r\nJustin T.,5/16/2025,Home,1,1,1,Single,0,0\r\nCarter H.,5/16/2025,Home,1,4,1,BB,0,0\r\nJavier E.,5/16/2025,Home,1,0,3,SO,0,0\r\nBrayan P.,5/16/2025,Home,2,4,2,BB,0,0\r\nShilin H.,5/16/2025,Home,2,4,2,BB,0,0\r\nMiguel R.,5/16/2025,Home,2,2,2,GO,0,0\r\nBarton Z.,5/16/2025,Home,2,2,3,SO,0,0\r\nNoah H.,5/16/2025,Home,2,1,3,SO,0,0\r\nEdgar C.,5/16/2025,Home,3,3,2,FO,0,0\r\nJustin T.,5/16/2025,Home,3,3,3,SO,0,0\r\nCarter H.,5/16/2025,Home,3,1,3,SO,0,0\r\nNoah H.,5/15/2025,Home,1,4,1,BB,0,0\r\nBarton Z.,5/15/2025,Home,1,4,1,BB,0,0\r\nJustin T.,5/15/2025,Home,1,4,2,BB,0,0\r\nCarter H.,5/15/2025,Home,1,2,1,Single,0,2\r\nJavier E.,5/15/2025,Home,1,4,0,BB,0,0\r\nShilin H.,5/15/2025,Home,1,1,3,SO,0,0\r\nMiguel R.,5/15/2025,Home,1,2,3,SO,0,0\r\nHuanchao Y.,5/15/2025,Home,1,4,2,BB,0,1\r\nAiden L.,5/15/2025,Home,1,2,3,SO,0,0\r\nNoah H.,5/15/2025,Home,2,4,1,BB,3,0\r\nBarton Z.,5/15/2025,Home,2,3,3,SO,0,0\r\nJustin T.,5/15/2025,Home,2,1,1,HBP,0,0\r\nCarter H.,5/15/2025,Home,2,1,0,HBP,0,0\r\nJavier E.,5/15/2025,Home,2,0,3,SO,0,0\r\nShilin H.,5/15/2025,Home,2,4,2,BB,0,0\r\nMiguel R.,5/15/2025,Home,2,0,3,SO,0,0\r\nHuanchao Y.,5/15/2025,Home,3,4,2,BB,0,0\r\nAiden L.,5/15/2025,Home,3,0,1,HBP,0,0\r\nNoah H.,5/15/2025,Home,3,0,1,FO,0,0\r\nBarton Z.,5/8/2025,Home,1,1,0,HR,0,1\r\nNoah H.,5/8/2025,Home,1,2,3,SO,0,0\r\nBrayan P.,5/8/2025,Home,1,1,3,SO,0,0\r\nEdgar C.,5/8/2025,Home,1,1,0,Single,0,0\r\nJustin T.,5/8/2025,Home,1,2,0,GO,0,0\r\nJavier E.,5/8/2025,Home,2,4,2,BB,0,0\r\nHuanchao Y.,5/8/2025,Home,2,4,1,BB,0,0\r\nCarter H.,5/8/2025,Home,2,0,3,SO,0,0\r\nBarton Z.,5/8/2025,Home,2,0,0,Single,0,2\r\nNoah H.,5/8/2025,Home,2,0,0,Double,0,0\r\nBrayan P.,5/8/2025,Home,2,1,3,SO,0,0\r\nBarton Z.,5/2/2025,Home,1,2,3,SO,0,0\r\nNoah H.,5/2/2025,Home,1,1,0,GO,0,0\r\nJustin T.,5/2/2025,Home,1,4,1,BB,0,0\r\nJavier E.,5/2/2025,Home,1,3,3,SO,0,0\r\nBrayan P.,5/2/2025,Home,2,0,1,FO,0,0\r\nAiden L.,5/2/2025,Home,2,4,2,BB,0,0\r\nHuanchao Y.,5/2/2025,Home,2,3,3,SO,0,0\r\nShilin H.,5/2/2025,Home,2,2,3,SO,0,0\r\n","type":"text"}]
